{"version":3,"sources":["js/app.js","../../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["SERVICE_UUID","RX_CHARACTERISTIC_UUID","TX_CHARACTERISTIC_UUID","txCharacteristic","rxCharacteristic","searchButton","readButton","writeButton","loading","init","document","querySelector","addEventListener","searchBLE","readValueBLE","writeValueBLE","className","navigator","bluetooth","requestDevice","optionalServices","acceptAllDevices","then","console","log","device","name","id","gatt","connect","server","getPrimaryService","Promise","all","service","getCharacteristic","characteristic","setInterval","readValue","message","value","buffer","Uint8Array","catch","error","getElementById","TextDecoder","decode","e","form_d","ary_u8","TextEncoder","encode","writeValue","window","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","split","Date","now","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","setTimeout","links","querySelectorAll","i","length","module"],"mappings":"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","file":"app.843fc521.map","sourceRoot":"../src","sourcesContent":["import '../scss/style.scss';\nconst SERVICE_UUID = \"713d0000-503e-4c75-ba94-3148f18d941e\";\nconst RX_CHARACTERISTIC_UUID = \"713d0002-503e-4c75-ba94-3148f18d941e\";\nconst TX_CHARACTERISTIC_UUID = \"713d0003-503e-4c75-ba94-3148f18d941e\";\n\n// Characteristic\nlet txCharacteristic;\nlet rxCharacteristic;\n\nlet searchButton;\nlet readButton;\nlet writeButton;\nlet loading;\n\nfunction init() {\n  searchButton = document.querySelector(\"#search-button\");\n  searchButton.addEventListener(\"click\", searchBLE);\n\n  readButton = document.querySelector(\"#read-button\");\n  readButton.addEventListener(\"click\", readValueBLE);\n\n  writeButton = document.querySelector(\"#write-button\");\n  writeButton.addEventListener(\"click\", writeValueBLE);\n\n  loading = document.querySelector(\"#loading\");\n}\n\n// search & connect\nfunction searchBLE() {\n  // ローディング画面の表示\n  loading.className = \"show\";\n\n  // acceptAllDevicesの場合optionalServicesが必要みたい\n  navigator.bluetooth.requestDevice({\n    optionalServices:[SERVICE_UUID],\n    acceptAllDevices:true\n  })\n  \n    .then(device => { \n      console.log(\"devicename:\" + device.name);\n      console.log(\"id:\" + device.id);\n\n      // 選択したデバイスに接続\n      return device.gatt.connect();\n    })\n\n    .then(server => {\n      console.log(\"success:connect to device\");\n\n      // UUIDに合致するサービス(機能)を取得\n      return server.getPrimaryService(SERVICE_UUID);\n    })\n\n    .then(service => {\n      console.log(\"success:service\");\n      // UUIDに合致するキャラクタリスティック(サービスが扱うデータ)を取得\n      // 配列で複数のキャラクタリスティックの取得が可能\n      return Promise.all([\n        service.getCharacteristic(RX_CHARACTERISTIC_UUID),\n        service.getCharacteristic(TX_CHARACTERISTIC_UUID)\n      ]);\n      \n    })\n    .then(characteristic => {\n      console.log(\"success:txcharacteristic\");\n\n      rxCharacteristic = characteristic[0];\n      txCharacteristic = characteristic[1];\n      setInterval(() => {\n        rxCharacteristic.readValue()\n          .then(value => {\n            let message;\n            message = value.buffer;\n            console.log(new Uint8Array(message));\n      });\n      }, 1000)\n      \n\n      console.log(\"success:connect BLE\");      \n      loading.className = \"hide\";\n    })\n\n    .catch(error => {\n      console.log(\"Error : \" + error);\n\n      // loading非表示\n      loading.className = \"hide\";\n    });\n}\n\nfunction readValueBLE() {\nlet message;\n\n  try {\n    rxCharacteristic.readValue()\n      .then(value => {\n        message = value.buffer;\n        console.log(new Uint8Array(message));\n        document.getElementById(\"data-form\").value = new TextDecoder(\"utf-8\").decode(message);\n      });\n  }\n  catch (e) {\n    console.log(e);\n  }\n}\n\nfunction writeValueBLE() {\n  var form_d = document.getElementById(\"data-form\").value;\n\n  // formの文字列をUTF-8にしてTXCharacteristicに送信\n  // github.com/inexorabletash/text-encoding\n  var ary_u8 = new Uint8Array( new TextEncoder(\"utf-8\").encode(form_d) );\n  console.log(ary_u8);\n  try {\n    txCharacteristic.writeValue(ary_u8);\n  }\n  catch (e) {\n    console.log(e);\n  }\n}\n\nwindow.addEventListener(\"load\", init);\n\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}